<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>HWA: Main Page</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="extrastylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">HWA
   </div>
   <div id="projectbrief">HardWare Abstractor</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('index.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">HWA Documentation</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><code>HWA</code><sup>(*)</sup> is a hardware abstraction tool for programming microcontrollers in C language. A few features of HWA are useful for programming in assembler too.</p>
<p>HWA provides a set of object-oriented generic instructions that allow the programmer to focus on the result rather than the values that must be written into registers with the hope that it will lead to source codes easier to read, easier to maintain, and easier to port between different targets.</p>
<p>HWA is not a library. It is implemented at the preprocessing and compilation levels and a cache mechanism combined to the compiler's optimizers help HWA produce machine code free of any penalty, either in terms of size, execution speed or memory used.</p>
<div class="image">
<img src="hwa_principle.jpeg" alt="hwa_principle.jpeg"/>
</div>
<h2>Examples </h2>
<p>The <code>examples/</code> directory contains a few examples aimed at illustrating various features of HWA, currently only for Atmel ATtiny44 and ATtiny84 devices (ATtinyx5 and ATmegax8 should be available soon as they were already supported before HWA was last rewritten).</p>
<p>As a first check, you can run <code>make tests</code> in the HWA base directory to check that all examples compile without error. You'll need a properly configured avr-gcc toolchain for that (avr-libc is not required). You can also run <code>make checks</code> to verify that the generated code is the same that I obtained.</p>
<p>The <code>main.c</code> file of each example gives informations about what it does and how you can test it. A Python application is provided with the examples that can communicate with the host.</p>
<p>Files stored in the <code>examples/targets/</code> directory contain definitions for the targets I use: configuration of the microcontroller (fuses...), configuration of the Diabolo bootloader, LED pins used on Arduino boards...</p>
<p>If you want to run one of these examples on a microcontroller in which you previously installed Diabolo (see below), you just have to connect your USB-UART adapter and run <code>make install</code>.</p>
<p>If you prefer to use another programming method, you'll find the machine code to be programmed in the <code>build/out.bin</code> file. In the Makefile, you can define <code>PROG_SW</code> and <code>PROG_HW</code> with the names of your programming tools to override the default Diabolo. For example: </p>
<pre class="fragment">PROG_SW = avrdude
PROG_HW = usbasp
</pre><p>You'll have to provide a specific makefile if you use neither Diabolo nor avrdude. Look at the <code>examples/make/</code> directory.</p>
<h2>Documentation </h2>
<p>Run <code>make doc</code> in the HWA base directory to build the documentation in HTML format. You'll start with the <a href="doxygen/html/index.html">doxygen/html/index.html</a> page.</p>
<h2>Diabolo </h2>
<p>Diabolo is a bootloader (Diabolo Is A BOot LOader) that I developped using HWA for assembler programming. It is fast, as the host side uses a cache mecanism to determine pages that have to be programmed. It is not too big: ~640 bytes. It is very convenient since it can use 1 or 2-wire serial lines with auto-detection and auto-synchronization so that the baudrate does not have to be hardcoded in the project and no crystal is required for the device.</p>
<p>The source code of the device-side of Diabolo is under <code>examples/diabolo/device/diabolo.sx</code>.</p>
<p>The host-side Diabolo application is under <code>examples/diabolo/host/diabolo.py</code>.</p>
<h2>Swuarta </h2>
<p>Swuarta is a software UART for Atmel AVR devices. It is used in the examples so that the same code can be written, the device having an UART or not. This is also an example of hardware virtualization that you can do with HWA. Swuarta is programmed in assembler and you'll find the source code under <code>hwa/atmel/avr/swuarta/</code>.</p>
<p>In the examples, the swuart uses the same I/O pins as Diabolo so that you will not have to touch any wire between programming and executing the example.</p>
<h2>Status </h2>
<p>WARNING: this project is subject to heavy changes of the code-base, including project-wide name changes.</p>
<p>Because I do this as a hobby in my spare time, sometimes not touching it for several weeks, the development pace of HWA is as much irregular as the road I follow. Besides, I have many things to learn about Doxygen, git or just about project management.</p>
<p>So, though I started to write it in 2010, HWA is still not stabilized. It was first designed to be used with STM32 devices, but making it also work with Atmel AVRs took me a lot of time because of the arrangement of the registers in these devices. That led me to rewrite HWA several times, as I discovered mistakes in the conception, new possibilities with the preprocessor or simply that I could make things better (e.g. object-oriented instructions accepting variable-length lists of arguments).</p>
<h2>License </h2>
<p>HWA is free software. See the <a class="el" href="license.html">License</a> page for license information.</p>
<p><sup>(*)</sup>: <em>"Wah! a statement or exclamation, in several languages that
shows pleasure, appreciation and surprise."</em> &ndash; Wikipedia. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
